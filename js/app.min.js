function getElementPosition(element){var val=0;return element.length>0&&(val=element.offset().top),val}function getElementHeight(element){var val=0;return element.length>0&&(val=element.outerHeight()),val}var mobileWidth=480,tabletWidth=768,largeWidth=960,desktopWidth=1170,blockBody=$("body"),blockFilter=$(".block-filter"),blockFilterSearch=$(".block-filter-search"),blockMenu=$(".block-menu"),blockInsideNavigation=$(".block-inside-navigation"),blockTransactions=$(".block-transactions"),blockHeader=$('header[role="banner"]'),blockUser=$(".block-user"),blockUserDetailsSummary=$(".block-user-details-summary"),blockUserDetailsFilter=$(".block-user-details-filter"),transitionEnd="webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",transactionPosition=getElementPosition(blockTransactions),menuHeight=getElementHeight(blockMenu);$(window).width()<=largeWidth&&(menuHeight=0);var insideNavigationHeight=getElementHeight(blockInsideNavigation);$(window).width()>desktopWidth&&(insideNavigationHeight=0);var headerHeight=getElementHeight(blockHeader),filterHeight=getElementHeight(blockFilterSearch),userHeight=getElementHeight(blockUser),userDetailsSummaryHeight=getElementHeight(blockUserDetailsSummary),userDetailsFilterHeight=getElementHeight(blockUserDetailsFilter),transactionsHeight=getElementHeight(blockTransactions),filterPosition=userHeight+menuHeight+userDetailsSummaryHeight+userDetailsFilterHeight+insideNavigationHeight;$(function(){form.init(),scroll.menuPosition()}),$(window).load(function(e){menu.init(),filter.init(),panel.init(),modal.init(),array.init(),createTransaction.init(),notification.init(),$(window).scroll()}),$(window).resize(function(e){scroll.menuPosition(),$(window).width()<largeWidth&&($(".block-filter, .block-menu").removeClass("is-fixed"),$(".block-filter").next().removeAttr("style"),blockTransactions.hasClass("is-open")&&menu.closePanelTransaction(e)),menuHeight=$(window).width()<=largeWidth?0:getElementHeight(blockMenu);var insideNavigationHeight=getElementHeight(blockInsideNavigation);$(window).width()>desktopWidth&&(insideNavigationHeight=0),headerHeight=getElementHeight(blockHeader),filterHeight=getElementHeight(blockFilterSearch),userHeight=getElementHeight(blockUser),userDetailsSummaryHeight=getElementHeight(blockUserDetailsSummary),userDetailsFilterHeight=getElementHeight(blockUserDetailsFilter),filterPosition=userHeight+menuHeight+userDetailsSummaryHeight+userDetailsFilterHeight+insideNavigationHeight;var stepActive=blockTransactions.find(".block-transaction.is-active").data("step");blockTransactions.scrollLeft($(window).width()*(stepActive-1));var myHeight=menuHeight+userHeight;blockTransactions.css("top",myHeight)}),$(window).scroll(function(){scroll.menuPosition(),$(window).scrollTop()+$(window).height()===$(document).height()?$('footer[role="contentinfo"]').addClass("is-active"):$('footer[role="contentinfo"]').removeClass("is-active"),$(window).scrollTop()>=$(".block-user").height()+$(".block-menu").height()?(blockTransactions.addClass("is-fixed"),blockTransactions.css("top",menuHeight)):(blockTransactions.removeClass("is-fixed"),blockTransactions.removeAttr("style")),$(window).scrollTop()>=$(".block-user").height()+$(".block-menu").height()&&$(window).width()>tabletWidth?($('body.menu-open header[role="banner"]').addClass("is-fixed"),$(".block-menu").addClass("is-fixed")):$(window).scrollTop()<$(".block-user").height()&&$(window).width()>tabletWidth&&($('body.menu-open header[role="banner"]').removeClass("is-fixed"),$(".block-menu").removeClass("is-fixed")),$(window).scrollTop()>=filterPosition&&$(window).width()>tabletWidth?($(".block-filter").addClass("is-fixed"),$(".block-filter").css("top",menuHeight),$(".block-filter").next().css("padding-top",filterHeight)):$(window).scrollTop()<filterPosition&&$(window).width()>tabletWidth&&($(".block-filter").removeClass("is-fixed"),$(".block-filter").removeAttr("style"),$(".block-filter").next().removeAttr("style")),$(window).scrollTop()>=$(".block-user").height()&&$(window).width()>tabletWidth?$(".page-content").css("padding-top",menuHeight+userHeight):$(".page-content").removeAttr("style")}),$(document).keyup(function(e){27===e.keyCode&&($(".panel, .modal, .array-line").removeClass("is-open"),$("body").removeClass("content-open show-background"))});var array={event:function(){$(document).on("click",'[data-action="open-more"] > .array-item-cell',this.openMore),$(document).on("click",'[data-action="close-more"]',this.closeMore)},openMore:function(e){e.preventDefault();var myLine=$(this).closest(".array-line"),myElement=myLine.find(".array-item-more"),docHeight=$(document).height();myElement.show(),myElement.height()+myElement.offset().top>docHeight&&myLine.addClass("is-bottom"),$(".block-array").find(".array-line").removeClass("is-open"),myLine.addClass("is-open")},closeMore:function(e){e.preventDefault(),$(this).closest(".array-line").removeClass("is-open")},init:function(){array.event()}},createTransaction={event:function(){$(document).on("click",'[data-action="modify-step-create-transaction"]',this.modifyStepCreateTransaction),$(document).on("click",'[data-action="validate-step-create-transaction"]',this.validateStepCreateTransaction),$(document).on("click",'[data-action="reset-create-transaction"]',this.resetCreateTransaction),$(document).on("click",'[data-action="send-code-validation-create-transaction"]',this.sendCodeValidationCreateTransaction),$(document).on("click",".block-transaction.step-1 .block-transaction-buttons .block-transaction-button",this.activeButtonTransaction)},previousStepCreateTransaction:function(time){return blockTransactions.animate({scrollLeft:"-="+$(window).width()},time,"easeInQuad"),!1},nextStepCreateTransaction:function(time){return blockTransactions.animate({scrollLeft:"+="+$(window).width()},time,"easeOutQuad"),!1},validateStepCreateTransaction:function(e){e.preventDefault();var myTransactionSection=$(this).closest(".block-transaction"),myTransactionForm=$(".block-transaction-form"),myTransactionAnimationTime=650,validateStep=0;myTransactionSection.hasClass("step-1")&&(createTransaction.nextStepCreateTransaction(myTransactionAnimationTime),validateStep=1),myTransactionSection.hasClass("step-2")&&(myTransactionForm.parsley().validate(),myTransactionForm.parsley().isValid()&&(createTransaction.nextStepCreateTransaction(myTransactionAnimationTime),validateStep=1)),myTransactionSection.hasClass("step-3")&&(createTransaction.nextStepCreateTransaction(myTransactionAnimationTime),validateStep=1),1==validateStep&&(blockTransactions.find(".block-transaction").removeClass("is-active"),myTransactionSection.next(".block-transaction").addClass("is-active"))},modifyStepCreateTransaction:function(e){e.preventDefault();var myTransactionSection=$(this).closest(".block-transaction"),myTransactionForm=$(".block-transaction-form"),myTransactionAnimationTime=325;myTransactionSection.hasClass("step-2")&&(myTransactionForm.parsley().reset(),myTransactionForm.trigger("reset"),myTransactionForm.find("select").selectric("refresh"),createTransaction.previousStepCreateTransaction(myTransactionAnimationTime)),myTransactionSection.hasClass("step-3")&&createTransaction.previousStepCreateTransaction(myTransactionAnimationTime),blockTransactions.find(".block-transaction").removeClass("is-active"),myTransactionSection.prev(".block-transaction").addClass("is-active")},resetCreateTransaction:function(e){e.preventDefault(),$(".block-transaction.step-1 .block-transaction-button").removeClass("is-active"),$(".block-transaction.step-2 .block-transaction-form").parsley().reset(),$(".block-transaction.step-2 .block-transaction-form").trigger("reset"),$(".block-transaction.step-2 .block-transaction-form select").selectric("refresh"),blockTransactions.animate({scrollLeft:0},450,"easeOutQuad")},sendCodeValidationCreateTransaction:function(e){e.preventDefault(),$(".block-transaction .confirm-code").show()},activeButtonTransaction:function(e){e.preventDefault(),$(".block-transaction.step-1 .block-transaction-buttons .block-transaction-button").removeClass("is-active"),$(this).addClass("is-active")},init:function(){createTransaction.event();var numberStepsTransactions=$(".block-transactions .block-transactions-wrapper > .block-transaction").size();$(".block-transactions .block-transactions-wrapper").width(numberStepsTransactions*$(window).width()+40)}},filter={event:function(){$(document).on("click",'[data-action="open-more-criteria"]',this.openMoreCriteria),$(document).on("click",'[data-action="close-more-criteria"]',this.closeMoreCriteria),$(document).on("click",'[data-action="close-callback-message"]',this.closeCallbackMessage)},openMoreCriteria:function(e){e.preventDefault();var $this=$(this);$(".block-filter-more").is(".is-open")?$this.text($this.data("label-open")):$this.text($this.data("label-close")),$(".block-filter-more").toggleClass("is-open")},closeMoreCriteria:function(e){e.preventDefault(),$('[data-action="open-more-criteria"]').trigger("click")},closeCallbackMessage:function(e){e.preventDefault(),$(this).closest(".callback").removeClass("is-open")},init:function(){filter.event()}},form={inputFile:function(){$(".file-input").each(function(){var $input=$(this),$label=$input.next("label"),labelVal=$label.html();$input.on("change",function(e){var fileName="";this.files&&this.files.length>1?fileName=(this.getAttribute("data-multiple-caption")||"").replace("{count}",this.files.length):e.target.value&&(fileName=e.target.value.split("\\").pop()),fileName?$label.find("span").html(fileName):$label.html(labelVal)}),$input.on("focus",function(){$input.addClass("has-focus")}).on("blur",function(){$input.removeClass("has-focus")})})},datePicker:function(){$(".datepicker").datepicker({firstDay:1,closeText:"Fermer",prevText:"Précédent",nextText:"Suivant",currentText:"Aujourd'hui",monthNames:["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"],monthNamesShort:["Janv","Févr","Mars","Avril","Mai","Juin","Juil","Août","Sept","Oct","Nov","Déc"],dayNames:["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"],dayNamesShort:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"],dayNamesMin:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"],weekHeader:"Sem.",dateFormat:"dd/mm/yy"})},select:function(){$("select").selectric(),$(".custom-options").selectric({optionsItemBuilder:function(itemData){return itemData.value.length?'<div class="selectric-options-text">'+itemData.text+'</div><div class="selectric-options-value">'+itemData.value+"</div>":'<div class="selectric-options-text">'+itemData.text+"</div>"}}),$("#DemandTypeList").selectric().on("change",function(){$('[data-type="request"] [data-section]').hide(),$('[data-type="request"] [data-section="'+$(this).val()+'"]').show()})},init:function(){form.inputFile(),form.datePicker(),form.select()}};animationComplete=!0;var menu={event:function(){$(document).on("click",'[data-action="open-menu"]',this.openMenu),$(document).on("click",'[data-action="open-panel-transaction"]',this.openPanelTransaction),$(document).on("click",'[data-action="close-panel-transaction"]',this.closePanelTransaction)},openMenu:function(e){e.preventDefault(),$(this).toggleClass("is-open"),blockMenu.toggleClass("is-open"),blockBody.toggleClass("menu-open show-background")},openPanelTransaction:function(e){if(e.preventDefault(),!blockTransactions.hasClass("is-open")){var transactionStep=blockTransactions.find(".block-transaction"),activeStep=0;transactionStep.each(function(){if($(this).hasClass("is-active"))return activeStep=1,!1}),0===activeStep&&(transactionStep.removeClass("is-active"),blockTransactions.find(".block-transaction.step-1").addClass("is-active"))}menu.togglePanelTransaction($(this))},closePanelTransaction:function(e){e.preventDefault(),menu.togglePanelTransaction(),createTransaction.resetCreateTransaction(e)},togglePanelTransaction:function(elem){animationComplete&&(animationComplete=!1,blockTransactions.toggleClass("is-open"),elem?elem.closest("li").toggleClass("is-active"):$(".menu-item.is-active").toggleClass("is-active"),$("body").toggleClass("transaction-open show-background"))},init:function(){menu.event(),blockTransactions.bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){animationComplete=!0})}},modal={event:function(){$(document).on("click","[data-modal]",this.openModal),$(document).on("click",'[data-action="close-modal"]',this.closeModal)},openModal:function(e){e.preventDefault();var myData=$(e.target).data("modal");myData||(myData=$(e.target).closest("[data-modal]").data("modal")),$('.modal[data-type="'+myData+'"]').addClass("is-open"),$("body").addClass("content-open show-background")},closeModal:function(e){e.preventDefault(),$(this).closest(".modal").removeClass("is-open"),$("body").removeClass("content-open show-background")},init:function(){modal.event()}},notification={event:function(){$(document).on("click",'[data-action="close-notification"]',this.closeNotification)},closeNotification:function(e){e.preventDefault();var elem=$(this).closest(".notification"),heightElem=elem.outerHeight();elem.css("bottom",-heightElem)},init:function(){notification.event()}},panel={event:function(){$(document).on("click","[data-panel]",this.openPanel),$(document).on("click",'[data-action="close-panel"]',this.closePanel)},openPanel:function(e){e.preventDefault();var myData=$(e.target).data("panel");myData||(myData=$(e.target).closest("[data-panel]").data("panel")),$('.panel[data-type="'+myData+'"]').addClass("is-open"),$("body").addClass("content-open show-background")},closePanel:function(e){e.preventDefault(),$(this).closest(".panel").removeClass("is-open"),$("body").removeClass("content-open show-background")},init:function(){panel.event()}},scroll={menuPosition:function(){var menuHeight=0;$(window).width()>desktopWidth-70&&(menuHeight=blockMenu.outerHeight());var userHeight=0;blockUser.length>0&&(userHeight=blockUser.outerHeight()),$(window).scrollTop()>=userHeight?blockInsideNavigation.length&&(blockInsideNavigation.css("top",0),blockInsideNavigation.css("padding-top",menuHeight)):blockInsideNavigation.length&&(blockInsideNavigation.css("top",userHeight-$(window).scrollTop()),blockInsideNavigation.css("padding-top",menuHeight))},init:function(){scroll.menuPosition()}};